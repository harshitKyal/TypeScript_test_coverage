[![semantic-release](https://img.shields.io/badge/%20%20%F0%9F%93%A6%F0%9F%9A%80-semantic--release-e10079.svg)](https://github.com/semantic-release/semantic-release)
[![Build status](https://badge.buildkite.com/0a1f4e4f3f03aa1e1a12ea38fc8df85ee223dcdcde7b159828.svg)](https://buildkite.com/vicinity-centres/eslint-config-vcx)

# Shared ESlint & TSlint

This repo contains both eslint (`index.js`) and tslint (`tslint.js`).

### Usage

#### Add as npm dependency

```
yarn add @vicinity/eslint-config-vcx -D
```

*NOTE* to use private npm registry you have to be logged in with `npm login`

#### ESlint

Create an `.eslintrc.json` file at the root of your project
```json
{
  "extends": "@vicinity/eslint-config-vcx"
}
```

#### TSLint

Create an `tslint.json` file at the root of your project
```json
{
  "extends": "@vicinity/eslint-config-vcx/tslint"
}
```

## Release

To automate the release process and simplify CI, we use the 
[the Angular commit message convention](https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#commits) which is also [the default commit message convention for `semantic-release`](https://github.com/semantic-release/semantic-release#default-commit-message-format). Please ensure you follow the guidelines.

### How it works?

A new release happens when the `master` branch builds successfully and there's a formatted commit message that should trigger a semantic version change. A Git tag is created, a GitHub release is created and the package is published to NPM under the new semantic version.

### Committing

We use [`commitlint`](https://github.com/marionebl/commitlint) for commit linting, and [`husky`](https://github.com/typicode/husky) for Git hooks to prevent bad `git commit` & `git push` (specifically, [the `commit-msg` hook](https://git-scm.com/docs/githooks#_commit_msg).

Take a look at the git history (`git log`) to get the gist of it.

If you'd like to get some CLI assistance for the commit message format:

```
npm install
npm run commit
```

The `npm run commit` script triggers a helpful commit message CLI ([the `commitlint cli` package](https://github.com/marionebl/commitlint/tree/master/@commitlint/cli))

***NOTE:*** If you're unsure of the options available when running this command you can type in `help` to see a list of options.

### Publishing

The process of creating git tag, updating [`CHANGELOG.md`, `package.json` , `package-lock.json`] and publishing to NPM is fully automated in Buildkite.

For each new commit added to the release branch (*master*) with `git push` or by merging a pull request, a CI build is triggered in Buildkite and runs the `semantic-release` command to make a release if there are codebase changes since the last release that affect the package functionalities.

### How to delete a tag
You may need to do this in the case that the release in BuildKite doesn't work or you accidentally create the tag on your local machine

Delete broken tag:
#### delete local tag 'X.Y.Z'
```
git tag -d "X.Y.Z"
```
#### delete remote tag 'X.Y.Z'
You will only need to run this if the tag created was pushed to the remote repository
```
git push origin :refs/tags/X.Y.Z
```
